<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="/index.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomePage</title>
</head>
<body>

    

    <div class="container">

        <div class="bar">
            <p>PIPING</p>
        </div>
    
        <div class="btnAddPiping">
            <div>
                <button onclick="onClickAddPiping()">Add Piping</button>
            </div>
        </div>

        <div class="tableAllDiv">
            <table>
                <thead>
                    <tr>
                        <th>Line Number</th>
                        <th>Location</th>
                        <th>From</th>
                        <th>To</th>
                        <th>Pip Size (inch)</th>
                        <th>Service</th>
                        <th>Material</th>
                        <th>-----------</th>
                    </tr>
                </thead>
                <tbody>

                    <% if (datalist.length > 0) { %>

                        <% for(i = 0;i<datalist.length;i++){ %>
                        <tr>
                            <td><%= datalist[i].line_number %></td>
                            <td><%= datalist[i].location %></td>
                            <td><%= datalist[i].from %></td>
                            <td><%= datalist[i].to %></td>
                            <td><%= datalist[i].pipe_size %></td>
                            <td><%= datalist[i].service %></td>
                            <td><%= datalist[i].material %></td>
                            <td>
                                <div id="buttonTableDiv">
                                    <button onclick="onClickInfo('pipingInfo/<%=datalist[i].line_number%>')" id="btnInfo">Info</button>
                                    <button onclick="onClickDetails('pipingDetails?line_number=<%=datalist[i].line_number%>&cml_number=-1&tp_number=-1')" id="btnDetails">Details</button>
                                </div>

                            </td>
                        </tr>
                        <% } %>

                    <% } %>
                    
                </tbody>
            </table>
        </div>

    </div>
    
    <script>
        const btnAddPiping = document.getElementById('btnAddPiping');
        
        function onClickInfo(link){
            console.log(link)
            window.location.href = link
        }


        function onClickDetails(link){
            console.log(link)
            window.location.href = link
        }

        function onClickAddPiping(){
            fetch('input_page',{
                method:"POST",
                body:JSON.stringify({ 
                    from:'info',
                    datalist:[]
                }),
                headers:{
                    "Content-Type": "application/json"
                }
            }).then((render)=>{
                render.text().then((str)=>{
                    document.write(str)
                })
                
            })
        }

    </script>

</body>
</html>